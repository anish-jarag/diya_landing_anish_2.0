---
import Layout from '~/layouts/PageLayout.astro';
import HeroText from '~/components/widgets/HeroText.astro';
import Features2 from '~/components/widgets/Features2.astro';
import Stats from '~/components/widgets/Stats.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import { getHomePermalink } from '~/utils/permalinks';

const metadata = {
  title: 'How It Works',
};
---

<Layout metadata={metadata}>
  <!-- HeroText Widget -->
  <HeroText
    tagline="Platform Walkthrough"
    title="A Smarter Way to Learn, Teach, and Manage"
    subtitle="Explore how the platform simplifies exams, content management, and performance tracking for schools and students."
  />

  <!-- Stats Widget (Impact Highlights) -->
  <Stats
    tagline="Measurable Impact"
    stats={[
      { amount: '20% Faster', title: 'Exam Results', icon: 'tabler:chart-line' },
      { amount: '2x', title: 'Student Engagement', icon: 'tabler:bulb' },
      { amount: 'Secure', title: 'Cheating-Resistant', icon: 'tabler:shield-lock' },
      { amount: 'Less Admin', title: 'for Management', icon: 'tabler:clipboard-check' },
    ]}
  />

  <!-- Features Widget -->
  <Features2
    tagline="<span class='block mb-4'>DIYA brings students, teachers, and institutions together on a single platform, making learning and teaching smarter, more accessible, and truly data-driven.</span>"
    title="Who Can Use DIYA?"
    subtitle="DIYA is built for all stakeholders in education"
    columns={3}
    items={[
      {
        title: 'Students',
        description: 'Take exams, get detailed results, and access learning videos and notes with ease.',
        icon: 'tabler:user',
      },
      {
        title: 'Teachers',
        description: 'Upload question sets, schedule exams, and track class-wide performance.',
        icon: 'tabler:school',
      },
      {
        title: 'Institutes',
        description: 'Monitor institute-wide analytics, manage staff, and view rankings.',
        icon: 'tabler:building',
      },
    ]}
    classes={{
      container: 'max-w-6xl',
      grid: 'grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8',
      item: 'p-8 rounded-2xl shadow-md bg-white border border-gray-100 hover:shadow-lg transition',
      title: 'text-2xl font-semibold text-blue-800',
      description: 'text-base text-gray-700 mt-2',
    }}
  />

  <!-- Student Journey Carousel -->
  <section class="py-16 bg-white dark:bg-gray-950">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-4">Student Journey</h2>
        <p class="text-lg text-gray-600 dark:text-gray-300">Simple steps to excel in your studies</p>
      </div>

      <div class="relative max-w-4xl mx-auto">
        <div class="student-carousel overflow-hidden rounded-lg shadow-lg">
          <div class="carousel-container flex transition-transform duration-500 ease-in-out">
            <!-- Slide 1: Login & Setup -->
            <div class="carousel-slide min-w-full bg-white dark:bg-gray-800 p-8 flex items-center">
              <div class="w-1/2 pr-8">
                <div class="flex items-center mb-4">
                  <div class="bg-blue-500 text-white rounded-full p-3 mr-4">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                      <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                      ></path>
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-blue-600">Getting Started</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Login & Setup</h3>
                <div class="space-y-3 text-gray-600 dark:text-gray-300">
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Secure Access</p>
                      <p class="text-sm">Login using your institute-provided credentials</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Choose Your Path</p>
                      <p class="text-sm">Select from available exams and subjects</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-1/2">
                <img
                  src="~/assets/images/ss/student_dashboard_p.jpg"
                  alt="Student login"
                  class="rounded-lg shadow-md"
                />
              </div>
            </div>

            <!-- Slide 2: Take Exam -->
            <div class="carousel-slide min-w-full bg-white dark:bg-gray-800 p-8 flex items-center">
              <div class="w-1/2 pr-8">
                <div class="flex items-center mb-4">
                  <div class="bg-green-500 text-white rounded-full p-3 mr-4">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                      <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                      ></path>
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-green-600">Exam Experience</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Smart Examination</h3>
                <div class="space-y-3 text-gray-600 dark:text-gray-300">
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Multilingual Support</p>
                      <p class="text-sm">Choose between English or Marathi interface</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Adaptive Testing</p>
                      <p class="text-sm">Shuffled questions with smart navigation tools</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-1/2">
                <img
                  src="~/assets/images/ss/multi_language.jpg"
                  alt="Student taking exam"
                  class="rounded-lg shadow-md"
                />
              </div>
            </div>

            <!-- Slide 3: Results & Learning -->
            <div class="carousel-slide min-w-full bg-white dark:bg-gray-800 p-8 flex items-center">
              <div class="w-1/2 pr-8">
                <div class="flex items-center mb-4">
                  <div class="bg-purple-500 text-white rounded-full p-3 mr-4">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"></path>
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-purple-600">Growth & Learning</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Results & Improvement</h3>
                <div class="space-y-3 text-gray-600 dark:text-gray-300">
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-purple-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Instant Analytics</p>
                      <p class="text-sm">Detailed performance metrics & topper comparisons</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-purple-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Learning Resources</p>
                      <p class="text-sm">Topic-wise videos and notes for skill improvement</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-1/2">
                <img
                  src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=500&q=80"
                  alt="Student analyzing results"
                  class="rounded-lg shadow-md"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- Carousel Navigation -->
        <div class="flex justify-center mt-6 space-x-2">
          <button class="carousel-dot w-3 h-3 rounded-full bg-blue-500 transition-colors duration-300" data-slide="0"
          ></button>
          <button
            class="carousel-dot w-3 h-3 rounded-full bg-gray-300 hover:bg-gray-400 transition-colors duration-300"
            data-slide="1"></button>
          <button
            class="carousel-dot w-3 h-3 rounded-full bg-gray-300 hover:bg-gray-400 transition-colors duration-300"
            data-slide="2"></button>
        </div>
      </div>
    </div>
  </section>

  <!-- Teacher Journey Carousel -->
  <section class="py-16 bg-white dark:bg-gray-950">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-4">Teacher Journey</h2>
        <p class="text-lg text-gray-600 dark:text-gray-300">Streamlined tools for effective teaching</p>
      </div>

      <div class="relative max-w-4xl mx-auto">
        <div class="teacher-carousel overflow-hidden rounded-lg shadow-lg">
          <div class="carousel-container flex transition-transform duration-500 ease-in-out">
            <!-- Slide 1: Content Management -->
            <div class="carousel-slide min-w-full bg-white dark:bg-gray-800 p-8 flex items-center">
              <div class="w-1/2 pr-8">
                <div class="flex items-center mb-4">
                  <div class="bg-green-500 text-white rounded-full p-3 mr-4">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-green-600">Content Creation</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Question Bank Management</h3>
                <div class="space-y-3 text-gray-600 dark:text-gray-300">
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Easy Upload</p>
                      <p class="text-sm">Import questions via Excel</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Smart Organization</p>
                      <p class="text-sm">Tag questions by topic, difficulty, and subject</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-1/2">
                <img
                  src="https://images.unsplash.com/photo-1551836022-deb4988cc6c0?auto=format&fit=crop&w=500&q=80"
                  alt="Teacher content management"
                  class="rounded-lg shadow-md"
                />
              </div>
            </div>

            <!-- Slide 2: Exam Management -->
            <div class="carousel-slide min-w-full bg-white dark:bg-gray-800 p-8 flex items-center">
              <div class="w-1/2 pr-8">
                <div class="flex items-center mb-4">
                  <div class="bg-blue-500 text-white rounded-full p-3 mr-4">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                      <path
                        d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"
                      ></path>
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-blue-600">Exam Control</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Flexible Scheduling</h3>
                <div class="space-y-3 text-gray-600 dark:text-gray-300">
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Custom Settings</p>
                      <p class="text-sm">Set timers, difficulty mix, and access windows</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Live Monitoring</p>
                      <p class="text-sm">Track exam progress and detect violations</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-1/2">
                <img
                  src="https://images.unsplash.com/photo-1552664730-d307ca884978?auto=format&fit=crop&w=500&q=80"
                  alt="Teacher exam management"
                  class="rounded-lg shadow-md"
                />
              </div>
            </div>

            <!-- Slide 3: Analytics & Insights -->
            <div class="carousel-slide min-w-full bg-white dark:bg-gray-800 p-8 flex items-center">
              <div class="w-1/2 pr-8">
                <div class="flex items-center mb-4">
                  <div class="bg-purple-500 text-white rounded-full p-3 mr-4">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"></path>
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-purple-600">Data & Insights</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">Performance Analytics</h3>
                <div class="space-y-3 text-gray-600 dark:text-gray-300">
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-purple-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Detailed Reports</p>
                      <p class="text-sm">Class-wise and individual student analytics</p>
                    </div>
                  </div>
                  <div class="flex items-start">
                    <span class="w-2 h-2 bg-purple-500 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                    <div>
                      <p class="font-medium text-gray-800 dark:text-gray-200">Learning Support</p>
                      <p class="text-sm">Upload topic-wise videos and study materials</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-1/2">
                <img
                  src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?auto=format&fit=crop&w=500&q=80"
                  alt="Teacher analytics"
                  class="rounded-lg shadow-md"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- Carousel Navigation -->
        <div class="flex justify-center mt-6 space-x-2">
          <button
            class="teacher-carousel-dot w-3 h-3 rounded-full bg-green-500 transition-colors duration-300"
            data-slide="0"></button>
          <button
            class="teacher-carousel-dot w-3 h-3 rounded-full bg-gray-300 hover:bg-gray-400 transition-colors duration-300"
            data-slide="1"></button>
          <button
            class="teacher-carousel-dot w-3 h-3 rounded-full bg-gray-300 hover:bg-gray-400 transition-colors duration-300"
            data-slide="2"></button>
        </div>
      </div>
    </div>
  </section>

  <!-- CallToAction Widget -->
  <CallToAction
    title="Experience the Platform"
    subtitle="Join our waitlist and be the first to use DIYA at your institute."
    actions={[
      {
        variant: 'primary',
        text: 'Join the Waitlist',
        href: getHomePermalink() + '#waitlist',
      },
    ]}
  />
</Layout>

<script>
  // Student Carousel
  const studentCarousel = document.querySelector<HTMLElement>('.student-carousel .carousel-container');
  const studentDots = document.querySelectorAll<HTMLButtonElement>('.carousel-dot');
  let currentSlide = 0;

  function showSlide(index: number) {
    const slideWidth = 100;
    if (studentCarousel) {
      studentCarousel.style.transform = `translateX(-${index * slideWidth}%)`;
    }

    studentDots.forEach((dot, i) => {
      dot.classList.toggle('bg-blue-500', i === index);
      dot.classList.toggle('bg-gray-300', i !== index);
    });
  }

  studentDots.forEach((dot, index) => {
    dot.addEventListener('click', () => {
      currentSlide = index;
      showSlide(currentSlide);
    });
  });

  // Auto-advance student carousel
  setInterval(() => {
    currentSlide = (currentSlide + 1) % 3;
    showSlide(currentSlide);
  }, 5000);

  // Teacher Carousel
  const teacherCarousel = document.querySelector<HTMLElement>('.teacher-carousel .carousel-container');
  const teacherDots = document.querySelectorAll<HTMLButtonElement>('.teacher-carousel-dot');
  let currentTeacherSlide = 0;

  function showTeacherSlide(index: number) {
    const slideWidth = 100;
    if (teacherCarousel) {
      teacherCarousel.style.transform = `translateX(-${index * slideWidth}%)`;
    }

    teacherDots.forEach((dot, i) => {
      dot.classList.toggle('bg-green-500', i === index);
      dot.classList.toggle('bg-gray-300', i !== index);
    });
  }

  teacherDots.forEach((dot, index) => {
    dot.addEventListener('click', () => {
      currentTeacherSlide = index;
      showTeacherSlide(currentTeacherSlide);
    });
  });

  // Auto-advance teacher carousel
  setInterval(() => {
    currentTeacherSlide = (currentTeacherSlide + 1) % 3;
    showTeacherSlide(currentTeacherSlide);
  }, 5000);
</script>

<style>
  .carousel-slide {
    flex: 0 0 100%;
    min-height: 450px; /* Set consistent minimum height */
  }

  .carousel-slide img {
    height: 350px; /* Fixed height for all images */
    width: 100%;
    object-fit: cover; /* Maintain aspect ratio while filling container */
  }

  .carousel-dot {
    cursor: pointer;
  }

  .teacher-carousel-dot {
    cursor: pointer;
  }

  @media (max-width: 768px) {
    .carousel-slide {
      flex-direction: column;
      text-align: center;
    }

    .carousel-slide .w-1/2 {
      width: 100%;
      padding: 0;
      margin-bottom: 2rem;
    }

    .carousel-slide .w-1/2:last-child {
      margin-bottom: 0;
    }

    .carousel-slide .pr-8,
    .carousel-slide .pl-8 {
      padding-left: 0;
      padding-right: 0;
    }
  }
</style>
